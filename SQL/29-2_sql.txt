Available Tables
Customers
customer_id	first_name	last_name	age	country
1	John	Doe	31	USA
2	Robert	Luna	22	USA
3	David	Robinson	22	UK
4	John	Reinhardt	25	UK
5	Betty	Doe	28	UAE
Orders
order_id	item	amount	customer_id
1	Keyboard	400	4
2	Mouse	300	4
3	Monitor	12000	3
4	Keyboard	400	1
5	Mousepad	250	2
Shippings
shipping_id	status	customer
1	Pending	2
2	Pending	4
3	Delivered	3
4	Pending	5
5	Delivered	1



operations


  SELECT *
  FROM Customers
  INNER JOIN Orders
  ON Customers.Customer_id = Orders.Customer_id;

left JOIN---------------------------------------

SELECT *
  FROM Customers
  LEFT JOIN Orders
  ON Customers.Customer_id = Orders.Customer_id;

--Show Customer name, items, and amount-------------------------------------
--inner join
SELECT 
    Customers.first_name,
    Customers.last_name,
    Orders.item,
    Orders.amount
FROM Customers
INNER JOIN Orders
ON Customers.customer_id = Orders.customer_id;

--right join
SELECT 
Customers.first_name,
Customers.last_name,
Orders.item,
Orders.amount
FROM Customers
LEFT JOIN Orders
ON Customers.customer_id = Orders.customer_id;

--Show customers who orderes keyboard----------------------------------

SELECT 
Customers.first_name,
Customers.last_name,
Orders.item,
Orders.amount
FROM Customers
LEFT JOIN Orders
ON Customers.customer_id = Orders.customer_id
WHERE Orders.item = 'Keyboard';

--number of orders per customers and show name of customers-------------------------------

SELECT 
    Customers.customer_id,
    Customers.first_name,
    Customers.last_name,
    COUNT(Orders.order_id) AS total_orders
FROM Customers
INNER JOIN Orders
ON Customers.customer_id = Orders.customer_id
GROUP BY Customers.customer_id, Customers.first_name, Customers.last_name;



-- find customers who have spent more than 500 in total-----------------------------------


SELECT 
    Customers.customer_id,
    Customers.first_name,
    Customers.last_name,
    COUNT(Orders.order_id) AS total_orders
FROM Customers
INNER JOIN Orders
ON Customers.customer_id = Orders.customer_id
GROUP BY Customers.customer_id, Customers.first_name, Customers.last_name;
HAVING SUM(Orders.amount) > 500;



--find the customers who ordered item not ordered by any USA Customer-------------------------

--find the customers who placed orderd but shipping is Delivered---------------------------------------

SELECT
    Customers.customer_id,
    Customers.first_name,
    Customers.last_name
FROM Customers
INNER JOIN Orders
    ON Customers.customer_id = Orders.customer_id
LEFT JOIN Shippings
    ON Orders.order_id = Shippings.shipping_id
WHERE Shippings.status = 'Delivered';